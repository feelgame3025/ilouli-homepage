# 멀티 프로젝트 가상호스트 설정 예시
# 각 프로젝트별로 별도 도메인/서브도메인 사용

# ============================================
# 프로젝트 1: ilouli.com (메인 홈페이지)
# ============================================
server {
    listen 80;
    server_name ilouli.com www.ilouli.com;

    root /home/feel3025/myproject/homepage/frontend/build;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}

# ============================================
# 프로젝트 2: api.ilouli.com (API 서버)
# ============================================
server {
    listen 80;
    server_name api.ilouli.com;

    location / {
        proxy_pass http://localhost:5000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}

# ============================================
# 프로젝트 3: blog.ilouli.com (블로그)
# ============================================
server {
    listen 80;
    server_name blog.ilouli.com;

    root /home/feel3025/myproject/blog/build;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }
}

# ============================================
# 프로젝트 4: dev.ilouli.com (개발 서버)
# ============================================
server {
    listen 80;
    server_name dev.ilouli.com;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}

# ============================================
# 사용 방법
# ============================================
# 1. 각 프로젝트별로 별도 파일로 분리:
#    /etc/nginx/sites-available/ilouli.com
#    /etc/nginx/sites-available/api.ilouli.com
#    /etc/nginx/sites-available/blog.ilouli.com
#
# 2. 심볼릭 링크 생성:
#    sudo ln -s /etc/nginx/sites-available/ilouli.com /etc/nginx/sites-enabled/
#
# 3. DNS 설정:
#    - ilouli.com -> 서버 IP
#    - api.ilouli.com -> 서버 IP
#    - blog.ilouli.com -> 서버 IP
#
# 4. SSL 인증서 (Let's Encrypt):
#    sudo certbot --nginx -d ilouli.com -d www.ilouli.com
#    sudo certbot --nginx -d api.ilouli.com
#    sudo certbot --nginx -d blog.ilouli.com
